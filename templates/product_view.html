{% extends 'base.html' %}

{% block title %} {{product_view.product_name}} {% endblock title %}

{% block body %}

<script>

    // var item = document.getElementById("add_to_cart")
    if (localStorage.getItem('add_to_cart') == null) {
      var cart = {};
    }
    else {
      cart = JSON.parse(localStorage.getItem('add_to_cart'));
      document.getElementById('add_to_cart').innerHTML = Object.keys(cart).length;
    }
  
  
    $(document).ready(function () {
      $(".add_to_cart").click(function () {
        console.log("Clickedüëç");
        var idstr = this.id.toString();
        console.log(idstr);
        if (cart[idstr] != undefined) {
          cart[idstr] = cart[idstr] + 1;
        }
        else {
          cart[idstr] = 1;
        }
        console.log(cart);
        localStorage.setItem('add_to_cart', JSON.stringify(cart));
        
        document.getElementById('add_to_cart').innerHTML = Object.keys(cart).length;
      });
    });
    
    $('#popcart').popover();
  
    document.getElementById("popcart").setAttribute('data-content', '<h> Cart for your item. </h5>');
  </script>

  <div class="container my-4">
    <div class="row">
        <div class="col-md-4">
            <div class="row">
                <img src="/media/{{product_view.image}}" width="233px" height="385px" alt="">
            </div> <br>
            <div>
              
              <div class="row">
                <div>
                  <form action="/checkout" method="post">
                    {% csrf_token %}
                    <button class="btn btn-warning px-4" style="width: 400px; margin-bottom: 10px; margin-right: 10px;" name="item_of_checkout" id="product_{{product_view.id}}" value="{{product_view.id}}"> Buy Now </button>
                  </form>
                </div> 
                <div>
                  <form action="/cart" method="post">
                    {% csrf_token %}
                    <button class="btn btn-primary add_to_cart" style="width: 400px;" id="product_{{product_view.id}}" name="item_of_cart" value="{{product_view.id}}"> Add To Cart </button>
                  </form>
                </div>
              </div>
              
            </div>
        </div>

        <div class="col-md-8">
            <h5 class="display-4"><b>{{product_view.product_name}}</b></h5>
            <br>
            <p><b>Rs.</b>{{product_view.price}}</p>
            <br>
            <p>{{product_view.desc}}</p>
        </div>
    </div>
</div>

{% endblock body %}